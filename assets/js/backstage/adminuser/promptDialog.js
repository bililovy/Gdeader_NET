$(".dialogbox .head button.close_dialog").hover(function(){$(this).css("background-position","-11px 11px");},function(){$(this).css("background-position","10px 11px");});if($(".dialogbox .dialog_content").find("div.form.changeinfo").length>0){$(".dialogbox .dialog_content div.form_item a.radio").click(function(){$(this).siblings("a").find("i.fa").addClass("fa-circle-o").removeClass("fa-dot-circle-o");$(this).find("i.fa").addClass("fa-dot-circle-o").removeClass("fa-circle-o");if($(this).attr("data-lock")=="candel"){$(this).siblings('input[type="hidden"]').val("1");}else{$(this).siblings('input[type="hidden"]').val("0");}});var username=$('input[name="username"]'),truename=$('input[name="truename"]'),email=$('input[name="email"]'),adminid=$('input[name="userid"]'),canbedelete=$('input[name="canbedelete"]');username.blur(function(){func_username($(this));});truename.blur(function(){func_truename($(this));});email.blur(function(){func_email($(this));});$("button.sure").click(function(){var userid=parseInt(adminid.val());if(isNaN(userid)||userid<=0){promptTips("操作参数缺失，请刷新页面重新尝试！");return false;}var bool_uname=true,bool_tname=true,bool_email=true;bool_uname=func_username(username);bool_tname=func_truename(truename);bool_email=func_email(email);if(bool_uname&&bool_tname&&bool_email){var $data={username:trimValue(username.val()),truename:trimValue(truename.val()),email:trimValue(email.val()),canbedelete:parseInt(canbedelete.val()),adminid:userid,handway:"setinfo"};$.post($adminUpdateUrl,$data,function(back){if(back.status==1){easyDialog.open({container:{content:"更新成功，即将刷新数据."},autoClose:2000,callback:function(){window.location.reload();}});}else{$(".form span.formtips").html('<i style="padding-left: 0;color: #DD2D28;display: inline; font-size:15px;padding-right: 5px;" class="fa fa-exclamation-circle"></i><span style="display: inline; color: #D31B26;">'+back.data+"</span>");setTimeout(function(){$(".form span.formtips").html("");},3000);}},"json");}else{$(".form span.formtips").html('<i style="padding-left: 0;color: #DD2D28;display: inline; font-size:15px;padding-right: 5px;" class="fa fa-exclamation-circle"></i><span style="display: inline; color: #D31B26;">表单还有错误，请检查！</span>');setTimeout(function(){$(".form span.formtips").html("");},3000);}});}else{if($(".dialogbox .dialog_content").find("div.form.changepwd").length>0){var oripassword=$('input[name="oripwd"]'),adminid=$('input[name="userid"]'),password=$('input[name="password"]'),confirmpwd=$('input[name="confirmpwd"]');oripassword.blur(function(){func_pwd($(this));});password.blur(function(){func_pwd($(this));});confirmpwd.blur(function(){func_confirmpwd($(this),password);});$("button.sure").click(function(){var userid=parseInt(adminid.val());if(isNaN(userid)||userid<=0){promptTips("操作参数缺失，请刷新页面重新尝试！");return false;}var bool_pwd=true,bool_confirm=true;bool_pwd=func_pwd(password);bool_confirm=func_confirmpwd(confirmpwd,password);if(bool_pwd&&bool_confirm){var $data={oripassword:trimValue(oripassword.val()),password:trimValue(password.val()),handway:"setpwd",adminid:userid};$.post($adminUpdateUrl,$data,function(back){if(back.status==1){easyDialog.open({container:{content:"密码更新成功，你可尝试用新密码登录！"},autoClose:2000});}else{$(".form span.formtips").html('<i style="padding-left: 0;color: #DD2D28;display: inline; font-size:15px;padding-right: 5px;" class="fa fa-exclamation-circle"></i><span style="display: inline; color: #D31B26;">'+back.data+"</span>");setTimeout(function(){$(".form span.formtips").html("");},3000);}},"json");}else{$(".form span.formtips").html('<i style="padding-left: 0;color: #DD2D28;display: inline; font-size:15px;padding-right: 5px;" class="fa fa-exclamation-circle"></i><span style="display: inline; color: #D31B26;">表单还有错误，请检查！</span>');setTimeout(function(){$(".form span.formtips").html("");},3000);}});}}$(".dialogbox").delegate(".close_dialog","click",function(){easyDialog.close();});$(".dialogbox").delegate("button.cancel","click",function(){easyDialog.close();});function func_username(o){var value=trimValue(o.val());if(has_cn(value)){setTips(o,"用户名不能包含中文");return false;}if(has_length_error(value,5,20)){setTips(o,"用户名长度5-20位字母或数字");return false;}if(is_all_numbers(value)){setTips(o,"用户名不能全是数字");return false;}if(is_same_chars(value)){setTips(o,"用户名是相同字符");return false;}setTips(o,"",true);return true;}function func_truename(o){var value=trimValue(o.val());if(!is_all_cn(value)){setTips(o,"真实姓名请输入汉字");return false;}if(has_length_error(value,2,12)){setTips(o,"用户名长度2-12个汉字");return false;}setTips(o,"",true);return true;}function func_email(o){var value=trimValue(o.val());if(!is_email(value)){setTips(o,"邮箱格式错误");return false;}setTips(o,"",true);return true;}function func_pwd(o){var value=trimValue(o.val());if(is_empty(value)){setTips(o,"密码不能不能为空！");return false;}if(!has_cn(value)){if(is_same_chars(value)){setTips(o,"密码不能为同一字符！");return false;}else{if(is_all_numbers(value)){setTips(o,"密码不能全为数字！");return false;}else{if(has_length_error(value,6,20)){setTips(o,"密码长度为6-20位！");return false;}setTips(o,"",true);return true;}}}else{setTips(o,"密码格式错误！");return false;}}function func_confirmpwd(confirm,pwd){if(confirm.val()!==pwd.val()){setTips(confirm,"两次密码不一致");return false;}else{setTips(confirm,"",true);return true;}}function setTips(o,tips,isDef){isDef=(isDef==null)?false:true;o.siblings("i.tips").html("");if(isDef){var defTips=o.siblings("i.tips").attr("placeholder");o.siblings("i.tips").text(defTips);}else{o.siblings("i.tips").html('<i style="padding-left: 0;color: #DD2D28;display: inline; font-size:15px;padding-right: 5px;" class="fa fa-exclamation-circle"></i><span style="display: inline; color: #D31B26;">'+tips+"</span>");}}